version: "3.8"

services:
  redis:
    image: "redis:alpine"
  agent:
    build: .
    command:
      [
        "./sweep.sh",
        "--gpt=${GPT}",
      ]
    volumes:
      - "${PWD}/logs:/tmp/bsuite"
      - "${HOME}/.cache/GPT/:/root/.cache/GPT"
      - "${HOME}/.cache/huggingface/:/root/.cache/huggingface"
    deploy:
      replicas: ${REPLICAS}